
<% if @deputy.nil? %>
  NENHUM POLÍTICO COM ESSA IDENTIFICAÇÃO
<% else %>
  <h2><%= @deputy.name %></h2>
  <%= image_tag("https://www.camara.leg.br/internet/deputado/bandep/#{@deputy.deputy_id}.jpg", alt: "Sem Foto") %>
  <br>
	<%= @deputy.deputy_id %>
  <br>
	<%= @deputy.cpf_format %>
  <br>
	<%= @deputy.party %>
  <br>
	<%= @deputy.federal_unity.upcase %>
  <hr>
  <h2>Despesas</h2>
  <p>Não compensadas: <%= @invoices[:normal] %></p>
  <p>Compensações: <%= @invoices[:compensations] %></p>
  <p>Total: <%= @invoices[:normal] + @invoices[:compensations] %></p>
  <p>Valor da maior despesa: <%= @deputy.most_expensive_invoice %></p>
  <p>Média mensal (Inclui compensações): <%= @invoices[:mean_by_month] %></p>

  <table>
		<thead>
			<th>
				Descrição
			</th>
			<th>
				Descrição Completa
			</th>
			<th>
				Fornecedor
			</th>
      <th>
				Tipo do Documento
			</th>
      <th>
				Data de Emissão
			</th>
      <th>
				Valor Líquido
			</th>
			<th>
				Link da Nota
			</th>
		</thead>
		<tbody>
			<% @deputy.invoices.order(:issue_date).each do |invoice| %>
				<tr>
					<td>
						<%= invoice.description %>
					</td>
					<td>
						<%= invoice.specific_description %>
					</td>
					<td>
						<%= invoice.seller %>
					</td>
					<td>
						<%= invoice.translate_kind %>
					</td>
					<td>
						<%= invoice.issue_date.nil? ? invoice.issue_date : invoice.issue_date.strftime("%d/%m/%Y") %>
					</td>
          <td>
						<%= invoice.value %>
					</td>
					<td>
						<%= invoice.url.blank? ? "Inexistente" : (link_to "Nota", invoice.url, target: "_blank") %>
					</td>
				</tr>
			<% end %>
		</tbody>
	</table>
<% end %>